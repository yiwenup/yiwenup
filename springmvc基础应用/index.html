<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=X-UA-Compatible content="IE=edge, chrome=1"><title>01_Spring MVC 基础应用 - Yiwenup - 持续沉淀</title><meta name=Description content="Yiwenup - 持续沉淀"><meta property="og:title" content="01_Spring MVC 基础应用">
<meta property="og:description" content="Spring MVC 基础应用 一、MVC体系 1.1 三层架构和MVC模式 我们的开发架构一般都是基于两种形式，一种是C/S架构，也就是客户端/服务器；另一种是B/S架"><meta property="og:type" content="article"><meta property="og:url" content="http://www.yiwenup.cloud/springmvc%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8/"><meta property="og:image" content="http://www.yiwenup.cloud/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-06-07T19:12:32+08:00"><meta property="article:modified_time" content="2022-06-07T19:12:32+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://www.yiwenup.cloud/logo.png"><meta name=twitter:title content="01_Spring MVC 基础应用"><meta name=twitter:description content="Spring MVC 基础应用 一、MVC体系 1.1 三层架构和MVC模式 我们的开发架构一般都是基于两种形式，一种是C/S架构，也就是客户端/服务器；另一种是B/S架"><meta name=application-name content="Yiwenup - 持续沉淀"><meta name=apple-mobile-web-app-title content="Yiwenup - 持续沉淀"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://www.yiwenup.cloud/springmvc%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8/><link rel=prev href=http://www.yiwenup.cloud/02_ddd%E6%8A%80%E6%9C%AF/><link rel=next href=http://www.yiwenup.cloud/01_ddd%E7%90%86%E8%AE%BA/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"01_Spring MVC 基础应用","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/www.yiwenup.cloud\/springmvc%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8\/"},"image":["http:\/\/www.yiwenup.cloud\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"Spring生态, MVC","wordcount":7170,"url":"http:\/\/www.yiwenup.cloud\/springmvc%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8\/","datePublished":"2022-06-07T19:12:32+08:00","dateModified":"2022-06-07T19:12:32+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":{"@type":"ImageObject","url":"http:\/\/www.yiwenup.cloud\/images\/avatar.png","width":320,"height":320}},"author":{"@type":"Person","name":"yiwenup"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Yiwenup - 持续沉淀"><span class=header-title-pre><i class='fas fa-piggy-bank'></i></span> Yiwen Up <span class=header-title-post><i class='fas fa-leaf'></i></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/categories/><i class='fas fa-folder-open'></i> 分类 </a><a class=menu-item href=/tags/><i class='fas fa-tags fa-fw'></i> 标签 </a><a class=menu-item href=/posts/><i class='fas fa-book'></i> 所有文章 </a><a class=menu-item href=/></a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Yiwenup - 持续沉淀"><span class=header-title-pre><i class='fas fa-piggy-bank'></i></span> Yiwen Up <span class=header-title-post><i class='fas fa-leaf'></i></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/categories/ title><i class='fas fa-folder-open'></i>分类</a><a class=menu-item href=/tags/ title><i class='fas fa-tags fa-fw'></i>标签</a><a class=menu-item href=/posts/ title><i class='fas fa-book'></i>所有文章</a><a class=menu-item href=/ title></a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">01_Spring MVC 基础应用</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-feather-alt"></i></a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/springmvc/><i class="far fa-folder fa-fw"></i>SpringMVC</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-06-07>2022-06-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 7170 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 15 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#spring-mvc-基础应用>Spring MVC 基础应用</a><ul><li><a href=#一mvc体系>一、MVC体系</a><ul><li><a href=#11-三层架构和mvc模式>1.1 三层架构和MVC模式</a></li></ul></li><li><a href=#二spring-mvc-使用>二、Spring MVC 使用</a><ul><li><a href=#21-spring-mvc-流程示意>2.1 Spring MVC 流程示意</a></li><li><a href=#22-spring-mvc-原生应用>2.2 Spring MVC 原生应用</a></li><li><a href=#23-spring-mvc-原生应用拓展>2.3 Spring MVC 原生应用拓展</a></li></ul></li><li><a href=#三spring-mvc-九大组件>三、Spring MVC 九大组件</a></li><li><a href=#四数据封装原理>四、数据封装原理</a></li><li><a href=#五请求参数绑定>五、请求参数绑定</a><ul><li><a href=#51-原生-servlet-api-支持>5.1 原生 Servlet API 支持</a></li><li><a href=#52-简单参数>5.2 简单参数</a></li><li><a href=#53-pojo>5.3 POJO</a></li><li><a href=#54-日期>5.4 日期</a></li><li><a href=#55-requestparam>5.5 @RequestParam</a></li></ul></li><li><a href=#六spring-mvc-与-restful>六、Spring MVC 与 RESTful</a><ul><li><a href=#61-rest>6.1 REST</a></li><li><a href=#62-spring-mvc-支持>6.2 Spring MVC 支持</a></li></ul></li><li><a href=#七springmvc-的-ajax-支持>七、SpringMVC 的 Ajax 支持</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=spring-mvc-基础应用>Spring MVC 基础应用</h2><h3 id=一mvc体系>一、MVC体系</h3><h4 id=11-三层架构和mvc模式>1.1 三层架构和MVC模式</h4><blockquote><p>我们的开发架构一般都是基于两种形式，一种是<code>C/S</code>架构，也就是客户端/服务器；另一种是<code>B/S</code>架构 ，也就是浏览器服务器。在 JavaEE 开发中，几乎全都是基于<code>B/S</code>架构的开发。那么在<code>B/S</code>架构中，系统标准的三层架构包括：表现层、业务层、持久层。</p><p>而<code>MVC</code>是一种应用于表现层的设计模式，或者说风格，是<code>Model-View-Controller</code>的缩写。</p></blockquote><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231108133530197.png data-srcset="../images/image-20231108133530197.png, ../images/image-20231108133530197.png 1.5x, ../images/image-20231108133530197.png 2x" data-sizes=auto alt=../images/image-20231108133530197.png title=image-20231108133530197></p><p><strong>从三层架构来看：</strong></p><ul><li>表现层：即<code>web</code>层，负责接收客户端请求，依赖业务层的处理结果，将结果响应客户端。表现层通常使用的代码组织模式即<code>MVC</code>。</li><li>业务层：负责处理主要业务逻辑，依赖持久层完成数据操作，事务应当加在业务层。</li><li>持久层：负责和数据交互，完成数据查询与持久化操作。</li></ul><p><strong>从<code>MVC</code>模式来看：</strong></p><ul><li>View（视图）：通常指代我们的<code>html</code>和<code>jsp</code>页面，渲染和展示数据模型。</li><li>Model（模型）：模型分<strong>数据模型</strong>和<strong>业务模型</strong>，数据模型封装数据，业务模型封装业务要素。</li><li>Controller（控制器）：在应用程序中用于处理用户交互的部分。</li></ul><h3 id=二spring-mvc-使用>二、Spring MVC 使用</h3><blockquote><p><code>Spring MVC</code>全称为<code>Spring Web MVC</code>，可以认为是<code>Spring Framework</code>的一个模块。</p><p><code>Spring MVC</code>是一个基于<code>MVC</code>模式的轻量级<code>Web</code>框架，其本质上可以认为是对原生<code>Servlet</code>的简化。</p></blockquote><h4 id=21-spring-mvc-流程示意>2.1 Spring MVC 流程示意</h4><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231108192624536.png data-srcset="../images/image-20231108192624536.png, ../images/image-20231108192624536.png 1.5x, ../images/image-20231108192624536.png 2x" data-sizes=auto alt=../images/image-20231108192624536.png title=image-20231108192624536></p><ol><li>用户发送请求，由<code>DispatcherServlet</code>统一接收处理；</li><li><code>DispatcherServlet</code>将请求派发，从<code>HandlerMapping</code>获取处理器映射关系；</li><li><code>HandlerMapping</code>返回执行处理链，其中会包含一些<code>Interceptor</code>；</li><li><code>DispatcherServlet</code>调度<code>HandlerAdapter</code>执行请求；</li><li><code>HandlerAdapter</code>调用具体的<code>Handler</code>处理请求，<strong>此处基于适配器模式，兼容注解式<code>@Controller</code>的处理器或者实现接口<code>org.springframework.web.servlet.mvc.Controller</code>的一些处理器，或者不同类型的出/入参</strong>；</li><li>处理器返回<code>ModelAndView</code>；</li><li><code>HandlerAdapter</code>将返回的<code>ModelAndView</code>传递回<code>DispatcherServlet</code>；</li><li><code>DispatcherServlet</code>根据<code>ViewResolver</code>规则，查询视图模板；</li><li><code>ViewResolver</code>返回视图模板规则；</li><li><code>DispatcherServlet</code>根据视图模板和数据模型，完成视图渲染；</li><li><code>DispatcherServlet</code>最终响应用用户，至此流程结束。</li></ol><h4 id=22-spring-mvc-原生应用>2.2 Spring MVC 原生应用</h4><ol><li><p>创建测试项目，主要目录结构为<code>src/main/java</code>、<code>src/main/resources</code>、<code>src/main/webapp</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- pom.xml 添加 tomcat7 运行插件 --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;build&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;plugins&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;plugin&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;groupId&gt;</span>org.apache.tomcat.maven<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;artifactId&gt;</span>tomcat7-maven-plugin<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;version&gt;</span>2.2<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;configuration&gt;</span>
</span></span><span class=line><span class=cl>                <span class=c>&lt;!-- 应用上下文路径 --&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;path&gt;</span>/context1<span class=nt>&lt;/path&gt;</span>
</span></span><span class=line><span class=cl>                <span class=c>&lt;!-- tomcat 监听端口号 --&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;port&gt;</span>8080<span class=nt>&lt;/port&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/configuration&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/plugin&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/plugins&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/build&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- webapp/WEB-INF/web.xml --&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE web-app PUBLIC
</span></span></span><span class=line><span class=cl><span class=cp> &#34;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&#34;
</span></span></span><span class=line><span class=cl><span class=cp> &#34;http://java.sun.com/dtd/web-app_2_3.dtd&#34; &gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;web-app&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/web-app&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;!-- webapp/index.jsp --&gt;
</span></span><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>&lt;body&gt;
</span></span><span class=line><span class=cl>&lt;h2&gt;Hello World!&lt;/h2&gt;
</span></span><span class=line><span class=cl>&lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></td></tr></table></div></div><p>按以上文件补充至测试项目中，运行命令<code>mvn tomcat7:run</code>，即启动<code>tomcat</code>服务，待启动完成之后，访问：<code>localhost:{端口}/{上下文路径}</code>，若看见<code>index.jsp</code>页面的内容，表示测试项目的初步搭建成功。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231108224430733.png data-srcset="../images/image-20231108224430733.png, ../images/image-20231108224430733.png 1.5x, ../images/image-20231108224430733.png 2x" data-sizes=auto alt=../images/image-20231108224430733.png title=image-20231108224430733></p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231108224452195.png data-srcset="../images/image-20231108224452195.png, ../images/image-20231108224452195.png 1.5x, ../images/image-20231108224452195.png 2x" data-sizes=auto alt=../images/image-20231108224452195.png title=image-20231108224452195></p></li><li><p>添加<code>spring-webmvc</code>依赖</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- pom.xml 添加 spring-webmvc 运行插件 --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;dependencies&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;groupId&gt;</span>org.springframework<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;artifactId&gt;</span>spring-webmvc<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependencies&gt;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>在<code>web.xml</code>中注册<code>DispatcherServlet</code>组件，配置<code>spring-webmvc</code>的拦截规则</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE web-app PUBLIC
</span></span></span><span class=line><span class=cl><span class=cp> &#34;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&#34;
</span></span></span><span class=line><span class=cl><span class=cp> &#34;http://java.sun.com/dtd/web-app_2_3.dtd&#34; &gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;web-app&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- 注册 springmvc 的 DispatcherServlet --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;servlet&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>springmvc<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class=nt>&lt;/servlet-class&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/servlet&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!--
</span></span></span><span class=line><span class=cl><span class=c>   配置 springmvc 的 DispatcherServlet 拦截规则
</span></span></span><span class=line><span class=cl><span class=c>   方式一：后缀形式匹配（*.do/*.action/*.xxx）
</span></span></span><span class=line><span class=cl><span class=c>   方式二：/（该方式不拦截.jsp，此外的所有静态资源都将会被拦截）
</span></span></span><span class=line><span class=cl><span class=c>   方式三：/*（该方式拦截所有，包括.jsp）
</span></span></span><span class=line><span class=cl><span class=c>   --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>springmvc<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/web-app&gt;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>新增控制器<code>DemoController</code>，通过注解<code>@Controller</code>和<code>@RequestMapping</code>声明为一个处理器。当客户端请求<code>localhost:{端口}/{上下文路径}/demo/handle01</code>时，跳转至<code>src/main/webapp/WEB-INF/jsp/success.jsp</code>，返回服务端时间。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/demo&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>DemoController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/handle01&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>ModelAndView</span><span class=w> </span><span class=nf>handle01</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ModelAndView</span><span class=w> </span><span class=n>modelAndView</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ModelAndView</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>modelAndView</span><span class=p>.</span><span class=na>addObject</span><span class=p>(</span><span class=s>&#34;date&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Date</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 跳转至成功页面</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>modelAndView</span><span class=p>.</span><span class=na>setViewName</span><span class=p>(</span><span class=s>&#34;/WEB-INF/jsp/success.jsp&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>modelAndView</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;%@ page contentType=&#34;text/html;charset=UTF-8&#34; isELIgnored=&#34;false&#34; language=&#34;java&#34; %&gt;
</span></span><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>&lt;head&gt;
</span></span><span class=line><span class=cl>    &lt;title&gt;成功页面&lt;/title&gt;
</span></span><span class=line><span class=cl>&lt;/head&gt;
</span></span><span class=line><span class=cl>&lt;body&gt;
</span></span><span class=line><span class=cl>    &lt;!-- 此处使用EL表达式，从请求域取出key为date的值 --&gt;
</span></span><span class=line><span class=cl>    &lt;!-- 需要在文件头中声明 isELIgnored=&#34;false&#34; 否则EL表达式无法生效 --&gt;
</span></span><span class=line><span class=cl>请求成功，当前服务器时间：${date}
</span></span><span class=line><span class=cl>&lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></td></tr></table></div></div></li><li><p>新增<code>src/main/resources/springmvc.xml</code>配置，注册<code>Bean</code>扫描规则、<strong>处理器映射器和处理器适配器</strong>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;beans</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class=line><span class=cl>       <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>       <span class=na>xmlns:context=</span><span class=s>&#34;http://www.springframework.org/schema/context&#34;</span>
</span></span><span class=line><span class=cl>       <span class=na>xmlns:mvc=</span><span class=s>&#34;http://www.springframework.org/schema/mvc&#34;</span>
</span></span><span class=line><span class=cl>       <span class=na>xsi:schemaLocation=</span><span class=s>&#34;
</span></span></span><span class=line><span class=cl><span class=s>       http://www.springframework.org/schema/beans
</span></span></span><span class=line><span class=cl><span class=s>       http://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span class=line><span class=cl><span class=s>       http://www.springframework.org/schema/context
</span></span></span><span class=line><span class=cl><span class=s>       http://www.springframework.org/schema/context/spring-context.xsd
</span></span></span><span class=line><span class=cl><span class=s>       http://www.springframework.org/schema/mvc
</span></span></span><span class=line><span class=cl><span class=s>       http://www.springframework.org/schema/mvc/spring-mvc.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- 配置Bean扫描 --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;context:component-scan</span> <span class=na>base-package=</span><span class=s>&#34;cloud.yiwenup.sample.webmvc&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- 注册处理器映射器和处理器适配器 --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;mvc:annotation-driven/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/beans&gt;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>通过修改<code>src/main/webapp/WEB-INF/web.xml</code>，注册上述<code>springmvc.xml</code>至<code>DispatcherServlet</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- 注册 springmvc 的 DispatcherServlet --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>springmvc<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class=nt>&lt;/servlet-class&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;init-param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;param-name&gt;</span>contextConfigLocation<span class=nt>&lt;/param-name&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;param-value&gt;</span>classpath:springmvc.xml<span class=nt>&lt;/param-value&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/init-param&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet&gt;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>至此，运行命令<code>mvn tomcat7:run</code>启动服务端，访问<code>localhost:{端口}/{上下文路径}/demo/handle01</code>，页面返回服务端时间即成功。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231109110623701.png data-srcset="../images/image-20231109110623701.png, ../images/image-20231109110623701.png 1.5x, ../images/image-20231109110623701.png 2x" data-sizes=auto alt=../images/image-20231109110623701.png title=image-20231109110623701></p></li></ol><h4 id=23-spring-mvc-原生应用拓展>2.3 Spring MVC 原生应用拓展</h4><ul><li><p>我们在<code>DemoController</code>中配置的<code>ModelAndView</code>页面路径为物理路径，此处耦合了文件路径，可以通过配置视图解析器<code>ViewResolver</code>，定义前后缀拼接规则，后续交<strong>由视图解析器将逻辑路径转化为物理路径</strong>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- src/main/resources/springmvc.xml --&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- 配置视图解析器 --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;viewResolver&#34;</span> <span class=na>class=</span><span class=s>&#34;org.springframework.web.servlet.view.InternalResourceViewResolver&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;prefix&#34;</span> <span class=na>value=</span><span class=s>&#34;/WEB-INF/jsp/&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;suffix&#34;</span> <span class=na>value=</span><span class=s>&#34;.jsp&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/handle01&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>ModelAndView</span><span class=w> </span><span class=nf>handle01</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>ModelAndView</span><span class=w> </span><span class=n>modelAndView</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ModelAndView</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>modelAndView</span><span class=p>.</span><span class=na>addObject</span><span class=p>(</span><span class=s>&#34;date&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Date</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 完整视图物理路径由视图解析器组装</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>modelAndView</span><span class=p>.</span><span class=na>setViewName</span><span class=p>(</span><span class=s>&#34;success&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>modelAndView</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>除了使用<code>@Controller</code>声明请求处理器之外，还有一种实现接口<code>org.springframework.web.servlet.mvc.Controller</code>的方式，该方式仅了解即可。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Component</span><span class=p>(</span><span class=s>&#34;/demo2/handle02&#34;</span><span class=p>)</span><span class=w> </span><span class=c1>// 须显式指定Bean名称，该名称即为映射的请求路径</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Demo2Controller</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Controller</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * javax.servlet.http.HttpServletRequest 与 javax.servlet.http.HttpServletResponse
</span></span></span><span class=line><span class=cl><span class=cm>     * 依赖 servlet-api，需要在 pom.xml 中引入以下依赖：
</span></span></span><span class=line><span class=cl><span class=cm>     * &lt;dependency&gt;
</span></span></span><span class=line><span class=cl><span class=cm>     *      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
</span></span></span><span class=line><span class=cl><span class=cm>     *      &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
</span></span></span><span class=line><span class=cl><span class=cm>     *      &lt;version&gt;2.5&lt;/version&gt;
</span></span></span><span class=line><span class=cl><span class=cm>     *      &lt;scope&gt;provided&lt;/scope&gt;
</span></span></span><span class=line><span class=cl><span class=cm>     * &lt;/dependency&gt;
</span></span></span><span class=line><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>ModelAndView</span><span class=w> </span><span class=nf>handleRequest</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ModelAndView</span><span class=w> </span><span class=n>modelAndView</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ModelAndView</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>modelAndView</span><span class=p>.</span><span class=na>addObject</span><span class=p>(</span><span class=s>&#34;date&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Date</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 完整视图物理路径由视图解析器组装</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>modelAndView</span><span class=p>.</span><span class=na>setViewName</span><span class=p>(</span><span class=s>&#34;success&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>modelAndView</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ul><h3 id=三spring-mvc-九大组件>三、Spring MVC 九大组件</h3><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231109171440793.png data-srcset="../images/image-20231109171440793.png, ../images/image-20231109171440793.png 1.5x, ../images/image-20231109171440793.png 2x" data-sizes=auto alt=../images/image-20231109171440793.png title=image-20231109171440793></p><ul><li><strong>处理器映射器<code>org.springframework.web.servlet.HandlerMapping</code>：</strong><code>HandlerMapping</code>是用来查找<code>Handler</code>的，<code>Handler</code>具体可以是类，也可以是方法。<code>Handler</code>负责实际的请求处理，<strong>在请求到达<code>HandlerMapping</code>之后，其将会查询并返回包含<code>Handler</code>和<code>Interceptor</code>的执行链</strong>。</li><li><strong>处理器适配器<code>org.springframework.web.servlet.HandlerAdapter</code></strong>：<strong>由于<code>SpringMVC</code>支持多种形式的<code>Handler</code>声明，而最终都需要交由底层的<code>javax.servlet.Servlet#service</code>执行，因此需要<code>HandlerAdapter</code>介入完成适配职责</strong>。</li><li><strong>处理器异常解析器<code>org.springframework.web.servlet.HandlerExceptionResolver</code></strong>：在<code>Handler</code>发生异常时，由<code>HandlerExceptionResolver</code>根据异常设置<code>ModelAndView</code>，之后再将异常渲染至页面。</li><li><strong>视图解析器<code>org.springframework.web.servlet.ViewResolver</code></strong>：用于根据视图名<code>viewName</code>和区域<code>locale</code>解析出视图<code>View</code>。<code>View</code>可以渲染页面，即将数据填入模版中。默认情况下，<code>SpringMVC</code>会为我们注册<code>org.springframework.web.servlet.view.InternalResourceViewResolver</code>这个实现，他是用于<code>JSP</code>模版引擎的。</li><li><strong>文件上传解析器<code>org.springframework.web.multipart.MultipartResolver</code></strong>：主要用于文件上传，会将<code>HttpServletRequest</code>解析成<code>MultipartHttpServletRequest</code>，使其拥有文件相关功能。</li><li><strong>语言解析器<code>org.springframework.web.servlet.LocaleResolver</code></strong>：用于从请求中解析出<code>locale</code>，该组件为<code>i18n</code>的基础。</li><li><strong>主题解析器<code>org.springframework.web.servlet.ThemeResolver</code></strong>：用于解析主题。</li><li><strong>请求视图名转换器<code>org.springframework.web.servlet.RequestToViewNameTranslator</code></strong>：用于从请求中解析出视图名，<code>ViewResolver</code>需要根据<code>viewName</code>解析出<code>View</code>，但有的<code>Handler</code>并没有显式设置<code>viewName</code>，因此需要该组件，从请求中尝试解析出视图名<code>viewName</code>。</li><li><strong>重定向管理器<code>org.springframework.web.servlet.FlashMapManager</code></strong>：用来管理<code>FalshMap</code>的。<code>FlashMap</code>用于重定向时的参数传递，比如在处理用户订单时候，为了避免重复提交，可以处理完<code>post</code>请求之后重定向到一个<code>get</code>请求，这个<code>get</code>请求可以用来显示订单详情之类的信息。这样做虽然可以规避用户重新提交订单的问题，但是在这个⻚面上要显示订单的信息，这些数据从哪里来获得呢?因为重定向时没有有传递参数这一功能的，如果不想把参数写进<code>URL</code>（不推荐），那么就可以通过<code>FlashMap</code>来传递。只需要在重定向之前将要传递的数据写入请求（可以通过ServletRequestAttributes#getRequest方法获得）的属性<code>OUTPUT_FLASH_MAP_ATTRIBUTE</code>中，这样在重定向之后的<code>Handler</code>中<code>SpringMVC</code>就会自动将其设置到<code>Model</code>中，在显示订单信息的⻚面上就可以直接从Model中获取数据。</li></ul><h3 id=四数据封装原理>四、数据封装原理</h3><p>在第二节的例子中，通过使用<code>ModelAndView</code>将模型与视图返回，进一步的做一些变形，我们将<code>ModelAndView</code>放入方法形参中声明，实现效果也是一样的：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/handle02&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>ModelAndView</span><span class=w> </span><span class=nf>handle02</span><span class=p>(</span><span class=n>ModelAndView</span><span class=w> </span><span class=n>modelAndView</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>modelAndView</span><span class=p>.</span><span class=na>addObject</span><span class=p>(</span><span class=s>&#34;date&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Date</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>modelAndView</span><span class=p>.</span><span class=na>setViewName</span><span class=p>(</span><span class=s>&#34;success&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>modelAndView</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>我们继续观察<code>ModelAndView</code>的源码结构，可以发现其有两部分主要内容：<code>Objetc view</code>和<code>ModelMap model</code>。不难猜测<code>view</code>即我们之前的<code>success</code>页面名称，而<code>model</code>即我们之前放置数据的部分：</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231110144347132.png data-srcset="../images/image-20231110144347132.png, ../images/image-20231110144347132.png 1.5x, ../images/image-20231110144347132.png 2x" data-sizes=auto alt=../images/image-20231110144347132.png title=image-20231110144347132></p><p>于是，我们可以再一次对测试代码进行变形，将<code>view</code>和<code>model</code>拆分开来：此处将视图名称直接返回，而数据承载使用了<code>ModelMap</code>对象，发现效果也是一样的。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/handle03&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>handle03</span><span class=p>(</span><span class=n>ModelMap</span><span class=w> </span><span class=n>modelMap</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>modelMap</span><span class=p>.</span><span class=na>addAttribute</span><span class=p>(</span><span class=s>&#34;date&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Date</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=s>&#34;success&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>继续分析<code>ModelMap</code>的源码，可以发现，他本质上就是一个<code>Map</code>结构：</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231110144821353.png data-srcset="../images/image-20231110144821353.png, ../images/image-20231110144821353.png 1.5x, ../images/image-20231110144821353.png 2x" data-sizes=auto alt=../images/image-20231110144821353.png title=image-20231110144821353></p><p>那么，继续将测试代码变形，我们把形参直接替换成<code>Map</code>结构是否还会是同样的效果呢？答案是仍然一致！</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/handle04&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>handle04</span><span class=p>(</span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>map</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>map</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;date&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Date</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=s>&#34;success&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>除此之外，继续改造测试代码，将形参数据类型替换成<code>Model</code>，效果也是一样的。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/handle05&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>handle05</span><span class=p>(</span><span class=n>Model</span><span class=w> </span><span class=n>model</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>model</span><span class=p>.</span><span class=na>addAttribute</span><span class=p>(</span><span class=s>&#34;date&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Date</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=s>&#34;success&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>实际上，<code>ModelMap</code>、<code>Map</code>和<code>Model</code>在底层运行时，都是<code>BindingAwareModelMap</code>类型，具体关系如下图所示，所以不论如何替换，运行时的数据模型封装都使用<code>BindingAwareModelMap</code>对象。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231110152902643.png data-srcset="../images/image-20231110152902643.png, ../images/image-20231110152902643.png 1.5x, ../images/image-20231110152902643.png 2x" data-sizes=auto alt=../images/image-20231110152902643.png title=image-20231110152902643></p><h3 id=五请求参数绑定>五、请求参数绑定</h3><blockquote><p>在原生的<code>Serlvet</code>开发模式下，我们获取请求域中的参数，通常是通过<code>request.getParameter("age")</code>。而<code>Spring MVC</code>针对请求参数绑定的场景，使用<strong>反射</strong>的方式，为开发者提供了便利，只需要将形参名声明和报文中字段名对应上，就可以实现参数接收。</p></blockquote><h4 id=51-原生-servlet-api-支持>5.1 原生 Servlet API 支持</h4><blockquote><p>支持诸如<code>javax.servlet.http.HttpServletRequest</code>、<code>javax.servlet.http.HttpServletResponse</code>、<code>javax.servlet.http.HttpSession</code>等原生<code>Servlet API</code>。</p></blockquote><p>例如请求：<code>/demo/handle11?uid=333</code>。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231112173211222.png data-srcset="../images/image-20231112173211222.png, ../images/image-20231112173211222.png 1.5x, ../images/image-20231112173211222.png 2x" data-sizes=auto alt=../images/image-20231112173211222.png title=image-20231112173211222></p><h4 id=52-简单参数>5.2 简单参数</h4><blockquote><p>支持八种基本数据类型及其包装类。<strong>需要注意以下要点：</strong></p><ol><li>应使用包装类型，因为基础类型都有默认值，无法表示<code>null</code></li><li><code>Boolean</code>类型支持：<code>true</code>、<code>false</code>、<code>0</code>、<code>1</code></li></ol></blockquote><p>例如请求：<code>/demo/handle12?uid=333&amp;flag=0</code>。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231112173245268.png data-srcset="../images/image-20231112173245268.png, ../images/image-20231112173245268.png 1.5x, ../images/image-20231112173245268.png 2x" data-sizes=auto alt=../images/image-20231112173245268.png title=image-20231112173245268></p><h4 id=53-pojo>5.3 POJO</h4><blockquote><p>支持<code>POJO</code>封装。本质上也是通过反射实现赋值，需要满足如下操作即可。</p><ol><li>直接声明形参</li><li>传输的参数名称要求和声明形参的参数名称一一对应。</li><li>如果有<code>POJO</code>嵌套，则只需要用<code>.</code>表示映射路径</li></ol></blockquote><p>例如请求：<code>/demo/handle13?uid=333&amp;flag=0&amp;order.oid=1</code>。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231112174515604.png data-srcset="../images/image-20231112174515604.png, ../images/image-20231112174515604.png 1.5x, ../images/image-20231112174515604.png 2x" data-sizes=auto alt=../images/image-20231112174515604.png title=image-20231112174515604></p><h4 id=54-日期>5.4 日期</h4><blockquote><p>日期需要显式声明日期格式，否则针对前端传来的日期字符串，<code>Spring MVC</code>无法准确的将其映射成一个日期对象，进而抛出异常。</p></blockquote><p>例如请求：<code>/demo/handle14?date=2023-11-12</code>。</p><p>若缺少日期格式转换的配置，则将会出现如下<code>400</code>问题。服务端抛出异常<code>MethodArgumentTypeMismatchException</code></p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231112175332445.png data-srcset="../images/image-20231112175332445.png, ../images/image-20231112175332445.png 1.5x, ../images/image-20231112175332445.png 2x" data-sizes=auto alt=../images/image-20231112175332445.png title=image-20231112175332445></p><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231112175431076.png data-srcset="../images/image-20231112175431076.png, ../images/image-20231112175431076.png 1.5x, ../images/image-20231112175431076.png 2x" data-sizes=auto alt=../images/image-20231112175431076.png title=image-20231112175431076></p><p>而日期格式化配置，需要实现<code>org.springframework.core.convert.converter.Converter</code>接口，具体实现如下：</p><ol><li><p>实现<code>org.springframework.core.convert.converter.Converter</code>接口</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>DateConverter</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Converter</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Date</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>convert</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>source</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SimpleDateFormat</span><span class=w> </span><span class=n>sdf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SimpleDateFormat</span><span class=p>(</span><span class=s>&#34;yyyy-MM-dd&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>sdf</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=n>source</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>ParseException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>通过<code>org.springframework.format.support.FormattingConversionServiceFactoryBean</code>将自定义转换策略注册</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- src/main/resources/springmvc.xml --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;conversionService&#34;</span> <span class=na>class=</span><span class=s>&#34;org.springframework.format.support.FormattingConversionServiceFactoryBean&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;converters&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;set&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;bean</span> <span class=na>class=</span><span class=s>&#34;cloud.yiwenup.sample.webmvc.converter.DateConverter&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/set&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>为处理器适配器<code>org.springframework.web.servlet.config.AnnotationDrivenBeanDefinitionParser</code>注册<code>conversion-service</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- src/main/resources/springmvc.xml --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;mvc:annotation-driven</span> <span class=na>conversion-service=</span><span class=s>&#34;conversionService&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=../images/image-20231112192819521.png data-srcset="../images/image-20231112192819521.png, ../images/image-20231112192819521.png 1.5x, ../images/image-20231112192819521.png 2x" data-sizes=auto alt=../images/image-20231112192819521.png title=image-20231112192819521></p><h4 id=55-requestparam>5.5 @RequestParam</h4><blockquote><p><code>@RequestParam</code>注解用于解决传参和形参名称不一致的场景，完成显式映射规则指定。<strong>但要注意的是，其声明的传参别名，不再兼容原形参名称。</strong></p></blockquote><h3 id=六spring-mvc-与-restful>六、Spring MVC 与 RESTful</h3><blockquote><p><code>RESTful</code>是一种<code>web</code>软件架构⻛格，它不是标准也不是协议，它倡导的是一个资源定位及资源操作的⻛格。</p></blockquote><h4 id=61-rest>6.1 REST</h4><p>REST（Representational State Transfer）</p><ul><li>表现层<code>Representational</code>：把资源具体呈现出来的形式，叫做它的表现层。比如，文本可以用<code>txt</code>格式表现，也可以用<code>HTML</code>格式、<code>XML</code>格式、<code>JSON</code>格式表现，甚至可以采用二进制格式。</li><li>状态转化<code>State Transfer</code>：每发出一个请求，就代表了客户端和服务器的一次交互过程。</li></ul><p>个人理解其思想是将网络上的任何事物（歌曲、视频、服务、文本等）都抽象成一种资源，这些资源有很多的<strong>表现形式</strong>，可以是<code>xml</code>、可以是<code>json</code>、设置可以是二进制格式。那么每一次的请求都是对这些资源的操作，引导资源的<strong>状态发生改变</strong>。</p><ul><li>在不需要遵循<code>RESTful</code>的时候，定义的接口通常是在<code>url</code>中以<strong>动词+名词</strong>的形式来表示本次资源操作，比如：<code>http://localhost:8080/user/queryUserById?id=3</code></li><li>在<code>RESTful</code>的风格建议下，通常是用需要操作的资源的<code>uri</code>标识声明在<code>url</code>中，而将操作分离出来，表现在请求方式中，比如：<code>GET http://localhost:8080/user/3</code>，<strong>具体的表现就是<code>url</code>中不再会表现出操作，即不会有动词。</strong></li></ul><h4 id=62-spring-mvc-支持>6.2 Spring MVC 支持</h4><blockquote><p>原生<code>Spring MVC</code>与原生<code>HTML</code>并不支持<code>GET</code>和<code>POST</code>之外的请求类型。</p></blockquote><ol><li><p>原生<code>HTML</code>实现<code>PUT</code>、<code>DELETE</code>支持</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;post&#34;</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;/demo/user/333&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- 通过 hidden 的 input 标签，将 delete 操作以 _method 传入 --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;hidden&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;_method&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;delete&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;提交DELETE请求&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>原生<code>Spring MVC</code>实现<code>PUT</code>、<code>DELETE</code>支持</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- src/main/resources/springmvc.xml --&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- 注册REST请求支持 PUT、DELETE --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;filter&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;filter-name&gt;</span>restfulFilter<span class=nt>&lt;/filter-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;filter-class&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class=nt>&lt;/filter-class&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/filter&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;filter-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;filter-name&gt;</span>restfulFilter<span class=nt>&lt;/filter-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- 注意此处是 /* --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/*<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/filter-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;/user/{uid}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>method</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestMethod</span><span class=p>.</span><span class=na>DELETE</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>handle15</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=p>(</span><span class=s>&#34;uid&#34;</span><span class=p>)</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>uid</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>uid</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=s>&#34;success&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=七springmvc-的-ajax-支持>七、SpringMVC 的 Ajax 支持</h3><blockquote><p><code>Spring MVC</code>主要使用**<code>@RequestBody</code><strong>和</strong><code>@ResponseBody</code>**两个注解实现<code>Ajax</code>支持，前者能够将请求体中的<code>JSON</code>反序列化为参数对象，而后者能够将后端返回的响应对象序列化为<code>JSON</code>数据回调给<code>Ajax</code>处理。</p></blockquote><ol><li><p>引入<code>jackson</code>依赖，支持<code>JSON</code>处理</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>jackson-core<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>jackson-databind<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>jackson-annotations<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>前端<code>ajax</code>使用示例</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>Ajax json交互<span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>fieldset</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;button&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;ajaxBtn&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;ajax提交&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>fieldset</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>$</span><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>$</span><span class=p>(</span><span class=s2>&#34;#ajaxBtn&#34;</span><span class=p>).</span><span class=nx>bind</span><span class=p>(</span><span class=s2>&#34;click&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>url</span><span class=o>:</span> <span class=s1>&#39;/demo/handle07&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>data</span><span class=o>:</span> <span class=s1>&#39;{&#34;id&#34;:&#34;1&#34;,&#34;name&#34;:&#34;李四&#34;}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>contentType</span><span class=o>:</span> <span class=s1>&#39;application/json;charset=utf-8&#39;</span><span class=p>,</span> <span class=nx>dataType</span><span class=o>:</span> <span class=s1>&#39;json&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>success</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        	<span class=nx>alert</span><span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>后端代码示例</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/handle07&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 添加@ResponseBody之后，不再走视图解析器那个流程，而是等同于response直接输出数据</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=nd>@ResponseBody</span><span class=w> </span><span class=n>User</span><span class=w> </span><span class=nf>handle07</span><span class=p>(</span><span class=nd>@RequestBody</span><span class=w> </span><span class=n>User</span><span class=w> </span><span class=n>user</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=c1>// 业务逻辑处理，修改name为张三丰</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>user</span><span class=p>.</span><span class=na>setName</span><span class=p>(</span><span class=s>&#34;张三丰&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-06-07</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/spring%E7%94%9F%E6%80%81/>Spring生态</a>,&nbsp;<a href=/tags/mvc/>MVC</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/02_ddd%E6%8A%80%E6%9C%AF/ class=prev rel=prev title="02_DDD 技术篇"><i class="fas fa-angle-left fa-fw"></i>02_DDD 技术篇</a>
<a href=/01_ddd%E7%90%86%E8%AE%BA/ class=next rel=next title="01_DDD 理论篇">01_DDD 理论篇<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2021 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>yiwenup</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/twemoji@13.0.0/dist/twemoji.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:0},comment:{},lightGallery:{actualSize:!1,exThumbImage:"data-thumbnail",hideBarsDelay:2e3,selector:".lightgallery",speed:400,thumbContHeight:80,thumbWidth:80,thumbnail:!0},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},twemoji:!0}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>