---
title: "15 注入类攻防"
date: 2024-01-15T10:37:34+08:00
categories: ["Web安全和加速"]
tags: ["网络安全","技巧"]
draft: false
code:
  copy: true
toc:
  enable: true
---

> **注入类漏洞一般都是由于程序未将运行代码和用户输入数据分离而导致的。**注入类攻击总结有以下一些方式：
>
> - 持久性`XSS`：攻击者将恶意代码通过输入方式植入在服务端存储，任意用户触发该数据的查询就会执行恶意代码；
> - `SQL/ORM`注入
> - `XML`注入
> - 代码注入
> - `OS`命令注入

## 一、SQL/ORM注入攻防

> 攻击者一般会通过盲注的方式逐步去猜解数据库，形成`SQL`注入漏洞利用。
>
> 所谓盲注就是攻击者在不清楚服务端背后`SQL`逻辑的前提下，通过在输入位置构造简单的条件语句，通过页面返回的情况来判断漏洞是否存在。
>
> 所谓猜解数据库是指攻击者在明确漏洞存在的前提下，通过不断更改条件语句，达到摸清数据库表结构、库结构、执行用户等甚至直接拿到数据的目的。

比如针对一个输入框，可以

1. 尝试拼接`xxx and 1=1`看看是否能拿到一些额外的数据；
2. 使用`xxx and order by 1`、`xxx and order by 2`...语句尝试直到报错，即可确定当前`SQL`返回的列数量；
3. 使用`xxx and union select database(), user(), version()`就能拿到更多数据库信息

另外，对于使用了`ORM`框架的情况，我们也需要明确框架的特性：

- 针对`Mybatis`框架，`${}`底层是简单的字符串拼接，会出现`ORM`注入的问题；`#{}`底层才是会执行`SQL`预编译，从而避免`ORM`注入
- 针对`Hibernate`框架，一些定制的`HQL`实际上也会出现`ORM`注入问题，需要通过参数绑定特性才能避免`ORM`注入

## 二、XML注入攻防

## 三、代码注入攻防

## 四、OS命令注入攻防
